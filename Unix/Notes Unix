Cours : 7.8
Jeu de piste : E11

~ : pseudo de notre répertoire personnel (ou domicile) /~ = /user/6/yoeungm
~nom_user : pour aller dans le répertoire d'un autre utilisateur (si on a les droits)
~/.local/share/Trash/files : corbeille

atom : edit > preference > packages > options (linter pylint...)

cp ~jdpunix/jeu-de-piste/etape_b1.py . : étape du jeu de piste
le . correspond à ./ qui correspond au répertoire courant

/bin/
    Contient les fichiers exécutables strictement nécessaires au fonctionnement du système.
/usr/bin/
    Contient la plupart des fichiers exécutables du système. Il y en a beaucoup !
/etc/
    Contient les fichiers de configuration globaux du système.
/var/
    Contient les données gérées par le système.

cd repertoire : change directory
cd (sans rien) : cd ~ : cd au répertoire domicile

ls : liste les répertoires à un chemin donné en paramètre
-l : long : plus précis
-a : all : même les fichies cachés (.fichier)

mkdir : créer un répertoire

rm : supprime un fichier (commande générale qui supprime définitivement car ne met pas dans la poubelle)
rmdir : supprime un répertoire
rm -r : commande générale avec l'option r qui permet de supprimer un fichier de façon récursif (donc un répertoire et tout ce qu'il y a dedans) (= rmdir)

cp : copie un fichier dans ...
cp -r : permet de copier un fichier de façon récursif (donc un répertoire et tout ce qu'il y a dedans)


less : liste le contenu d'un fichier

mv : déplace ... dans ...
     mais aussi peut renommer le fichier ... en ... (si déplacement dans le même répertoire)
     on peut aussi déplacer et changer en même temps le nom du fichier

window : unix (LibreOffice > OpenDocument)
.doc : .odt : document texte (word...)
.xls : .ods : tableur (excel...)
.ppt : .odp : présentation (powerpoint...)

libreoffice : permet d'ouvrir un doc .odt (ou .txt ou .jpg ou .pdf ... mais modifié)

eog : permet de lire une image (fichier JPEG, PNG, GIF...) avec le logiciel Eye Of Gnome

acroread : permet de lire un .pdf (juste pour l'affichage) avec le logiciel Acrobat Reader
evince : idem

gimp : logiciel de retouche numérique

LaTeX : écriture d'un document texte (fichier.tex) qu'on peut compiler
pdflatex fichier.tex : convertit un fichier .tex en .pdf

atom : permet d'éditer du texte
vim : idem
emacs : idem
atom . : ouvre tous les fichiers du répertoire courant

atom [chemin] [nouveau_fichier] : créer un nouveau fichier là ou on veut

python3 fichier.py : exécute un fichier en python 3

#! /usr/bin/env python3 : à mettre en première ligne du script pour spécifier qu'il s'agit d'un programme python3 (et pas une ancienne version de python par exemple)

chmod +x [nom_fichier] : pour rajouter le droit en exécution

flake8 [nom_fichier] : logiciel pour détecter à la volée les erreurs / bugs potentiels à un instant t
pylint : encore plus exigeant que flake8

sleep [nombre_de_secondes] : met en pause le programme (on perd la main)
ctrl+c : pour nous redonner la main (si on ouvre un autre processus comme un logiciel etc...) en tuant l'application qui a été lancé à partir de ce terminal
commande & : pour nous donner la main juste après l’exécution d’une commande qui était censé nous faire perdre la main

ctrl + / : commente ou décommente un bloc de code

file : permet de "deviner" le type (au sens précis) d'un fichier (image, text...) mais pas toujours correct

droits : ugo : user group others (a pour all : tous)
user : utilisateur
group : chaque utilisateur appartient à un ou plusieurs groupes
	(par ex moi, "yoeungm" appartiens au groupe "etudiants"
others : tous les autres utilisateurs
Si un utilisateur est susceptible d'appartenir à plusieurs catégories, il appartient au plus propriétaire ; user > group > others
Donc en majorité, nos fichiers appartiennent à user
rwx : read write execute
Pour un répertoire :
read : lister contenu du répertoire (ls)
write : créer ou détruire un objet dans le répertoire (rm...)
execute : traverser le répertoire (cd)

chmod u-xw,go+w fichier : pour modifier les droits d'un fichier
= chmod u=r,go=rwx (dans notre cas)

setfacl -m u:yoeungm:r fichier : donner le droit à un utilisateur précis d'écrire dans un fichier

Remarques :
- On ne peut pas modifier un fichier sur lequel on a les droits en écriture mais qui se trouve dans un répertoire dans lequel on a pas le droit en écriture (par contre si le fichier se trouve dans un sous répertoire (d'un répertoire interdit en écriture) dont on a les droits en écriture, on peut)
- On peut lire dans un fichier qui se trouve dans un répertoire interdit à la lecture seulement dans le cas ou il se trouve dans un sous répertoire dont la lecture est autorisée
- On ne peut pas exécuter un fichier lorsqu'il se trouve dans un répertoire interdit en exécution (dans tous les cas) (car il faut pouvoir rentrer dans le fichier interdit avant de faire la suite)
- L'interdiction en exécution du répertoire courant nécessite de mettre "." et doit etre évité

Espace disque :
du (disk used) : pour connaître l'utilisation d'espace disque d'un fichier ou d'un répertoire (répertoire courant par défaut)
du -sh : pour summary (total en une ligne) et human readable (avec les unités)
df (disk fgree) : pour connaître l'espace disque pour chaque disque dur de la machine (chaque partition)
df -h : pour human readable (avec les unités)

Lecture du contenu d'un fichier :
less > more
less : entrée pour faire apparaître une ligne supplémentaire
       espace pour faire apparaître une page supplémentaire
       q pour quitter
       / pour chercher un mot
       & pour afficher les lignes contenant un motif de texte

less peut aussi être utilisé pour améliorer la lisibilité avec une autre commande (comme ls)
ls /usr/bin | less : on fait un less sur le résultat de l'affichage de ls

Lien symbolique :
Fait référence à un fichier ou à un répertoire
ln -s chemin_pointé nom_du_lien : création d'un lien symbolique

Remarque : La plupart des opérations (ouverture, lecture, 		   écriture) sur un lien symbolique le déréférencent 		   automatiquement et opèrent sur sa destination
	   La suppression (rm) et le déplacement/renommagemv) 	         portent sur le lien lui-même et n'affectent pas la 		   cible

Trouver un fichier :

find repertoire_depart criteres : permet de trouver un fichier
find . -name ... : permet de trouver un fichier par son nom à partir du répertoire courant (en descendant l'arborescence à partir du répertoire courant uniquement)
find . -name '*.py' : les fichiers qui ont l'extension .py
find . -mtime 6 : les fichiers dont on a édité il y a 6 jours

find . \( -name "*.py" -o -name "*.pyc" \) \-ctime +6 -a -ctime -14 \! -newer toto.py
: retrouver tous les fichiers python (source et byte code) que l'on a édité pendant la semaine dernière il y a plus de 6 fois 24 heures et moins de 14 fois 24 heures) sauf ceux qu'on a modifié après le fichier toto.py

Recherche dans un fichier :

grep expression_reguliere fichier1 fichier2 : recherche les lignes qui comportent une chaîne de caractère qui suit une expression régulière dans un (ou plusieurs) fichier(s)
cas particulier : expression_reguliere = chaine

Recherche dans un texte :
En combinant, avec | grep ...
Exemple : ps -A | grep gnome

Compression-decompression d'un fichier (avec gzip) :

gzip nom_fichier : compresse en .gz un fichier
gunzip nom_fichier.gz : décompresse un fichier .gz

Archiver plusieurs fichiers ou répertoires (avec tar) :

tar -cvf nom_fichier_cree.tar chemin_repertoire : archive en regroupant les fichiers et les répertoires dans un répertoire en un fichier nom_fichier_cree.tar
tar -xvf nom_fichier.tar : extrait le contenu d'une archive (nom_fichier.tar qui est un fichier .tar)

Archiver et compresser (avec tar) :

tar -czvf nom_fichier_cree.tar.gz chemin_repertoire : archive et compresse un répertoire en un fichier nom_fichier_cree.tar.gz (ou .tgz)
tar -xzvf nom_fichier_cree.tar.gz : décompresse et extrait un fichier .tar.gz

Archiver et compresser (avec zip) :

(Zip est un format qui est utilisé par tout le monde : ceux qui n'utilisent pas Unix, donc c'est le format à préférer)
zip -r nom_fichier_cree.zip chemin_repertoire : archive et compresse un répertoire en un fichier nom_fichier_cree.zip
unzip nom_fichier_cree.zip : décompresse et extrait un fichier .zip

Impression de documents :

lpstat -p nom_imprimante : pour voir les travaux en attente
cancel numero_impression : pour annuler l'impression s'il n'est pas trop tard
a2ps nom_fichier : lance l'impression du fichier (mise en page implicite en convertissant le fichier sous format .ps PostScript)
a2ps -o nom_fichier_reception.ps nom_fichier1 : envoie le résultat de la mise en page de l'impression dans nom_fichier_reception.ps (PostScript) (on peut mettre plusieurs nom_fichier pour avoir plusieurs pages dans nom_fichier_reception.ps)
lpr nom_fichier.ps : imprime un fichier sous format .ps (PostScript) uniquement
lp nom_fichier.ps : imprime un fichier sous format .ps (PostScript) uniquement
ps2pdf nomfichier.ps : convertit un fichier .ps en .pdf
pdf2ps nomfichier.pdf : convertit un fichier .pdf en .ps

Obtenir de l'aide :

nom_commande --help : aide rapide sur la commande (ou "help nom_commande" ou "nom_commande --h")
man nom_commande : ouvre la page du manuel unix concernant la commande (affiché sous la commande less donc on peut utiliser / pour chercher un mot par exemple)
info nom_commande : permet d'avoir beaucoup d'informations (comme avec man) sur une commande

Processus :

users : liste les utilisateurs qui exécutent des programmes (processus actifs) sur le même serveur que nous
top : liste les processus sur la machine par ordre décroissant d'utilisation des ressources du processeur
ps : liste tous les processus (programmes en cours d'exécution) de la machine
ps -u nom_user : liste les processus de nom_user
ps : liste les processus (sauf ce bash) de l'utilisateur courant
ps u : liste les processus en mode joli
ps -a : liste les processus (avec ce bash) de l'utilisateur courant
ps -A : liste tous les processus du système
lsof : liste les fichiers ouverts qui m'appartiennent

Fenêtre != processus
Les droits d'un processus sur les fichiers sont ceux de son propriétaire

kill numero_pid : demande à un processus de se terminer
kill -9 numero_pid : ordonne à un processus de se terminer
kill -9 -1 : ordonne à tous les processus de la session de se terminer (sans sauvegarde)
pkill nom_processus : termine un processus à partir de son nom de programme
Ctrl + C : raccourci pour terminre un processus (raccourci de kill)
xkill : lancé depuis un terminal, si on clique sur une fenêtre, on tue l'application à laquelle appartient cette fenêtre

----- jeu de piste -----

pdflatex fichier.tex : compiler fichier latex
file nom_fichier : permet de savoir le type d'un fichier (si pas d'extension .)
Ctrl + D : Demande l'arrêt d'un programme (Ctrl + C force l'arrêt)
./decoder.py < etape-E5.txt | ./decoder_bis.py : exemple pipe | avec double décodage successifs

sort | find -type f -size +500c : exemple trouver fichier le plus volumineux (en tatonnant avec -size et en faisant sort)
find ./ -type f | xargs ls -l | sort -n -k 5 : trouve les fichiers dans un répertoire, on le combine | avec xargs qui permet de reprendre le résultat de find pour faire un ls -l puis on le combine | avec sort sur la taille (on peut rajouter "| tail -n 1")
find ./ -type f -exec ls -l \; | sort -n -k 5 : trouve les fichiers dans un répertoire, on utilise -exec de find qui permet de reprendre le résultat de find pour faire un ls -l et s'arrêter à la fin ";" puis on le combine | avec sort sur la taille
ls -lR ./ | sort -n -k 5 : on fait un ls -l récursif sur le répertoire courant puis on le combine | avec sort sur la taille
find ./ -type f -exec wc -c {} \; | sort -n : méthode plus difficile
-> 5 méthodes pour trouver le fichier le plus gros

grep -r "Bravo, vous avez trouve l'etape E8." : exemple qui permet de trouver les fichiers qui contiennent cette chaîne de caractère
find . -type f | xargs grep "Bravo, vous avez trouve l'etape E8." : cherches dans tous les fichiers du répertoire courant s'il contient la chaîne de caractère

cat etape_E10.txt | grep "ETAPE-E10" : ne garde que les lignes qui contiennent "ETAPE-E10"

wget http://lig-enseignement.imag.fr/jeu-de-piste/yntsf/etape-E11.txt : permet de télécharger directement le fichier à l'url donné dans le répertoire courant

----------
